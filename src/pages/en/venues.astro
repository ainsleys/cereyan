---
import Layout from '../../layouts/Layout.astro';
import { t } from '../../i18n/translations';
import type { Venue } from '../../types';

import venuesData from '../../data/venues.json';

const lang = 'en';
const venues = (venuesData as Venue[]).filter(v => v.id !== 'various');

// Group venues by neighborhood
const venuesByNeighborhood = venues.reduce((acc, venue) => {
  const neighborhood = venue.neighborhood;
  if (!acc[neighborhood]) {
    acc[neighborhood] = [];
  }
  acc[neighborhood].push(venue);
  return acc;
}, {} as Record<string, Venue[]>);

const neighborhoods = Object.keys(venuesByNeighborhood).sort();
---

<Layout title={t(lang, 'venues.title')} lang={lang}>
  <div class="space-y-8">
    <!-- Page header -->
    <header class="mb-8">
      <h1 class="font-display font-bold text-2xl sm:text-3xl text-cinema-text mb-2">
        {t(lang, 'venues.title')}
      </h1>
      <p class="text-cinema-text-muted">
        {t(lang, 'venues.subtitle')}
      </p>
    </header>

    <!-- Venues by neighborhood -->
    {neighborhoods.map(neighborhood => (
      <section class="mb-10">
        <h2 class="date-header mb-4">
          {neighborhood}
        </h2>
        
        <div class="grid gap-4">
          {venuesByNeighborhood[neighborhood].map((venue, index) => (
            <article 
              class="screening-card animate-fade-in"
              style={`animation-delay: ${index * 0.05}s`}
            >
              <h3 class="font-display font-semibold text-lg text-cinema-text mb-2">
                {venue.name}
              </h3>
              
              {venue.address && (
                <div class="flex items-start gap-2 text-sm text-cinema-text-muted mb-3">
                  <svg class="w-4 h-4 mt-0.5 shrink-0 text-cereyan-pink" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                  <span>{venue.address}</span>
                </div>
              )}
              
              {venue.descriptionEn && (
                <p class="text-sm text-cinema-text-muted leading-relaxed">
                  {venue.descriptionEn}
                </p>
              )}
            </article>
          ))}
        </div>
      </section>
    ))}
  </div>
</Layout>


